{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/daniloviacavavizarreta/www/git/challenge-encora-next/src/app/page.tsx"],"sourcesContent":["\"use client\"\nimport { useEffect, useState } from \"react\";\n\ntype UserType = {\n  name: string;\n  work: string;\n  email: string;\n  telephone: string;\n  location: string;\n  image: string;\n}\n\ntype ChatType = {\n  id: string;\n  name: string;\n  messages: Array<[]>;\n}\n\nexport default function Home() {\n  const [user, setUser] = useState<UserType | null>(null);\n  const [chats, setChats] = useState<any | null>(null);\n  const [activeChat, setActiveChat] = useState<Boolean | null>(false);\n  const [chatSelected, setChatSelected] = useState<any | null>(null);\n  const [inputSearch, setInputSearch] = useState<any | null>(null);\n  const [inputConversation, setInputConversation] = useState<any | null>(null);\n\n  const handleInputSearch = (event: any) => {\n    setInputSearch(event.target.value)\n  }\n\n  const handleInputConversation = (event: any) => {\n    setInputConversation(event.target.value)\n  }\n\n  const createUser = async()=>{\n    const data = {\n      id: `conv-00` + (chats?.length + 1),\n      name: inputSearch,\n      messages: [\n        {\n          role: \"user\", content: \"How to learn Blockchain\"\n        },\n        {\n          role: \"encoraChat\", content: \"I have a routemap with 3 weeks for your lean Blockchain from zero.\",\n        }\n      ]\n    }\n    const response = await fetch(\"/chats\", {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: data ? JSON.stringify(data) : null,\n    })\n    const result = await response.json();\n    setChats([...chats, data])\n    setActiveChat(true)\n    setChatSelected(data)\n\n    console.log('user created', data, result)\n  }\n\n  const updateUser = async()=> {\n    setInputConversation('')\n    console.log(chatSelected, inputConversation)\n\n    const newMessage = [\n      { role: 'user', content: inputConversation },\n      { role: 'encoraChat', content: 'This is a simulated response from EncoraChat.' }\n    ];\n    \n    chatSelected.messages = [...chatSelected.messages, ...newMessage];\n  }\n\n  const getData = async()=>{\n    const res = await fetch(\"/api/whoami\");\n    const data = await res.json();\n    setUser(data.data);\n  }\n\n  const getDataList = async()=>{\n    const res = await fetch(\"/chats\");\n    const data = await res.json();\n    setChats(data.data);\n    console.log(data.data);\n  }\n\n  useEffect(()=>{\n    getData();\n    getDataList();  \n  }, [])\n\n  const changeChat = (chat: ChatType) => {\n    console.log(chats, chat)\n    setChatSelected(chat)\n    setActiveChat(true);\n  }\n\n  const deleteChat = (chat: ChatType) => {\n    const filteredChats = chats?.filter((c: ChatType) => c.id !== chat.id);\n    setChats(filteredChats);\n    if (chatSelected?.id === chat.id) {\n      setActiveChat(false);\n      setChatSelected(null);\n    }\n  }\n\n  const newChat = () => {\n    setActiveChat(false)\n    setInputSearch('')\n  }\n\n  const handleSearch = (e: any) => {\n    if (e.key == 'Enter') {\n      createUser();\n    }\n  }\n\n  const handleConversation = (e: any) => {\n    if (e.key == 'Enter') {\n      updateUser();\n      let history = document.getElementById('chatSelected')\n      let interval: any = null;   \n      interval = setInterval(function() {\n        history.scrollTop = history.scrollHeight\n        clearInterval(interval)\n      }, 1)\n      \n    }\n  }\n\n  const handleInputSearchHistory = (e: any) => {\n    console.log(chats)\n    if (e.target.value === '') {\n      setChats(chats)\n    } else {\n      const searchTerm = e.target.value.toLowerCase();\n      const newChats: [] = chats;\n      const filteredChats = newChats.filter((chat: ChatType) =>\n        chat.name.toLowerCase().includes(searchTerm)\n      );\n      setChats(filteredChats);\n    }\n  }\n\n  return (\n    <div className=\"font-sans flex justify-items-center h-screen\">\n      <section className=\"left p-4\">\n        <div className=\"logo\">\n          <h2 className=\"pb-30\">EncoraChat</h2>\n\n          <h3 \n            className=\"pb-10 cursor-pointer\"\n            onClick={newChat}\n          >\n            Nuevo Chat\n          </h3>\n\n          <p className=\"pb-5\">Chats</p>\n          <ul>\n            {chats?.map((chat: ChatType, index: number) => (\n              <li key={index} className=\"flex justify-between\">\n                <a onClick={() => changeChat(chat)} className=\"cursor-pointer\">\n                  {chat.name}\n                </a>\n                <div onClick={() => deleteChat(chat)}>x</div>\n              </li>\n            ))}\n          </ul>\n\n          <input \n            type=\"text\" \n            placeholder=\"Buscar en historial\" \n            className=\"rounded-xl mt-20 w-80 p-2 border\"\n            onChange={handleInputSearchHistory}\n          />\n        </div>\n      </section>\n\n      <section className=\"right p-4\">\n        <div className=\"chat text-center\">\n          {\n            !activeChat ? (\n              <>\n                <h1 className=\"text-xl\">¿Qué tienes en mente hoy?</h1>\n                <div className=\"buscador mb-20 \">\n                  <input \n                    className=\"flex justify-center items-center border rounded-xl mt-4 w-100 p-2\"\n                    placeholder=\"Escribe algo\"\n                    type=\"text\"\n                    onKeyDown={handleSearch}\n                    onChange={handleInputSearch}\n                    value={inputSearch}\n                  />\n                </div>\n              </>\n            ) : (\n              <>\n                <p className=\"mb-15\">{chatSelected?.name}</p>\n                <ul id=\"chatSelected\" className=\"text-left chat-selected\">\n                  {chatSelected?.messages?.map((men: any, index: number) => (\n                    <li key={index} className=\"mb-5\">\n                      {men.content}\n                    </li>\n                  ))}\n                </ul>\n                <div className=\"buscador mb-20 fixed bottom-0\">\n                  <input \n                    className=\"flex justify-center items-center border rounded-xl mt-4 w-100 p-2\"\n                    placeholder=\"Escribe algo\"\n                    type=\"text\"\n                    onKeyDown={handleConversation}\n                    onChange={handleInputConversation}\n                    value={inputConversation}\n                  />\n                </div>\n              </>\n            )\n          }\n        </div>\n      </section>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}